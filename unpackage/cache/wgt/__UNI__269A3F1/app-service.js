if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((n=>t.resolve(e()).then((()=>n))),(n=>t.resolve(e()).then((()=>{throw n}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...n){uni.__log__?uni.__log__(e,t,...n):console[e].apply(console,[...n,t])}function n(e){uni.request({url:e.url,data:e.data,header:e.header||{Authorization:""},method:e.method||"POST",success:t=>{t.data.custom&&e.success({custom:t.data.custom,status:t.data.status})},fail:e.faile})}uni.addInterceptor("request",{invoke:e=>{if(-1==e.url.indexOf("http")&&(e.url="http://127.0.0.1:9527/"+e.url),!uni.getStorageSync("access_token")&&-1==e.url.indexOf("login"))return uni.showToast({title:"111"}),void uni.navigateTo({url:"/pages/login/login",animationType:"slide-in-right"});uni.getStorageSync("refresh_token")&&new Promise(((e,t)=>{n({url:"user/refresh",data:{refresh_token:uni.getStorageSync("refresh_token")},success:function(n){if(1==n.status.code){uni.setStorageSync("access_token",n.custom.access_token),uni.setStorageSync("refresh_token",n.custom.refresh_token);const t={access_token:n.custom.access_token,refresh_token:n.custom.refresh_token};e(t)}else uni.showToast({title:"登录已过期，请重新登录"}),t({})}})})).then((e=>{})).catch((()=>{uni.navigateTo({url:"/pages/login/login",animationType:"slide-in-right"})})),e.header.Authorization="Bearer "+uni.getStorageSync("access_token")},success:e=>{t("log","at utils/fetch.ts:40",e),e.data.code=1},fail:e=>{t("log","at utils/fetch.ts:45","interceptor-fail",e)}});const r={__name:"index",setup(t){const r=e.ref("test");return n({url:"http://127.0.0.1:9527/user/login",data:{username:"111",password:"456"},success:function(e){r.value=JSON.stringify(e)}}),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"content"},[e.createElementVNode("image",{class:"logo",src:"/static/logo.png"}),e.createElementVNode("view",{class:"text-area"},[e.createElementVNode("text",{class:"title"},e.toDisplayString(r.value),1)])]))}};const o=((e,t)=>{const n=e.__vccOpts||e;for(const[r,o]of t)n[r]=o;return n})({data:()=>({})},[["render",function(t,n,r,o,a,i){return e.openBlock(),e.createElementBlock("view")}]]);__definePage("pages/index/index",r),__definePage("pages/login/login",o);const a={onLaunch:function(){t("log","at App.vue:6","App Launch")},onShow:function(){t("log","at App.vue:9","App Show")},onHide:function(){t("log","at App.vue:12","App Hide")}};const{app:i,Vuex:s,Pinia:u}={app:e.createVueApp(a)};uni.Vuex=s,uni.Pinia=u,i.provide("__globalStyles",__uniConfig.styles),i._component.mpType="app",i._component.render=()=>{},i.mount("#app")}(Vue);
